if(void 0===__webpack_require__)var __webpack_require__={};(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[9111],{8453:(s,e,n)=>{n.d(e,{R:()=>t,x:()=>r});var a=n(6540);const i={},l=a.createContext(i);function t(s){const e=a.useContext(l);return a.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),a.createElement(l.Provider,{value:e},s.children)}},9524:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>t,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"chapter-06/lesson-02","title":"Lesson 6.2: Balance Control","description":"Inverted pendulum models, stabilization strategies","source":"@site/i18n/ur/docusaurus-plugin-content-docs/current/chapter-06/lesson-02.md","sourceDirName":"chapter-06","slug":"/chapter-06/lesson-02","permalink":"/physical-ai-book/ur/docs/chapter-06/lesson-02","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"bipedal","permalink":"/physical-ai-book/ur/docs/tags/bipedal"},{"inline":true,"label":"locomotion","permalink":"/physical-ai-book/ur/docs/tags/locomotion"},{"inline":true,"label":"balance","permalink":"/physical-ai-book/ur/docs/tags/balance"},{"inline":true,"label":"zmp","permalink":"/physical-ai-book/ur/docs/tags/zmp"},{"inline":true,"label":"gait","permalink":"/physical-ai-book/ur/docs/tags/gait"}],"version":"current","frontMatter":{"title":"Lesson 6.2: Balance Control","description":"Inverted pendulum models, stabilization strategies","chapter":6,"lesson":2,"estimated_time":60,"cefr_level":"B2","blooms_level":"Apply","digcomp_level":5,"generated_by":"claude-sonnet-4-5-20250929","source_spec":"specs/002-physical-ai-textbook/spec.md","created":"2025-11-29","last_modified":"2025-11-29","git_author":"hswat","workflow":"/sp.implement","version":"1.0","prerequisites":["chapter-06-lesson-01","chapter-05-lesson-04"],"has_interactive_python":false,"interactive_python_count":0,"has_try_with_ai":true,"try_with_ai_count":2,"tags":["bipedal","locomotion","balance","zmp","gait"]},"sidebar":"tutorialSidebar","previous":{"title":"Lesson 6.1: Bipedal Locomotion Basics","permalink":"/physical-ai-book/ur/docs/chapter-06/lesson-01"},"next":{"title":"Lesson 6.3: Whole-Body Motion Planning","permalink":"/physical-ai-book/ur/docs/chapter-06/lesson-03"}}');var i=n(4848),l=n(8453);const t={title:"Lesson 6.2: Balance Control",description:"Inverted pendulum models, stabilization strategies",chapter:6,lesson:2,estimated_time:60,cefr_level:"B2",blooms_level:"Apply",digcomp_level:5,generated_by:"claude-sonnet-4-5-20250929",source_spec:"specs/002-physical-ai-textbook/spec.md",created:"2025-11-29",last_modified:"2025-11-29",git_author:"hswat",workflow:"/sp.implement",version:"1.0",prerequisites:["chapter-06-lesson-01","chapter-05-lesson-04"],has_interactive_python:!1,interactive_python_count:0,has_try_with_ai:!0,try_with_ai_count:2,tags:["bipedal","locomotion","balance","zmp","gait"]},r="Lesson 6.2: Bipedal Locomotion Basics",c={},m=[{value:"Introduction",id:"introduction",level:2},{value:"1. Linear Inverted Pendulum Model (LIP)",id:"1-linear-inverted-pendulum-model-lip",level:2},{value:"2. Ankle vs. Hip Strategies",id:"2-ankle-vs-hip-strategies",level:2},{value:"3. ZMP-Based Stabilization",id:"3-zmp-based-stabilization",level:2},{value:"Interactive Exercises",id:"interactive-exercises",level:2},{value:"Exercise 6.2.1: LIP Dynamics Simulator",id:"exercise-621-lip-dynamics-simulator",level:3},{value:"Exercise 6.2.2: PD Balance Controller",id:"exercise-622-pd-balance-controller",level:3},{value:"Exercise 6.2.3: Ankle vs. Hip Strategy Comparison",id:"exercise-623-ankle-vs-hip-strategy-comparison",level:3},{value:"Exercise 6.2.4: Push Recovery Simulation",id:"exercise-624-push-recovery-simulation",level:3},{value:"TryWithAI Exercises",id:"trywithai-exercises",level:2},{value:"TryWithAI 6.2.1: Adaptive Balance Controller",id:"trywithai-621-adaptive-balance-controller",level:3},{value:"TryWithAI 6.2.2: Multi-Contact Balance Optimization",id:"trywithai-622-multi-contact-balance-optimization",level:3},{value:"Summary",id:"summary",level:2}];function h(s){const e={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msqrt:"msqrt",msub:"msub",msup:"msup",mtext:"mtext",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",ul:"ul",...(0,l.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"lesson-62-bipedal-locomotion-basics",children:"Lesson 6.2: Bipedal Locomotion Basics"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Prerequisites"}),": ",(0,i.jsx)(e.a,{href:"/physical-ai-book/ur/docs/chapter-06/lesson-01",children:"Lesson 6.1: Humanoid Kinematics and Dynamics"}),", ",(0,i.jsx)(e.a,{href:"/physical-ai-book/ur/docs/chapter-05/",children:"Chapter 5: Dynamics and Control"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(e.p,{children:"Maintaining balance is critical for humanoid robots. The inverted pendulum model simplifies humanoid dynamics to a single mass on a massless rod, enabling tractable controller design. This lesson covers Linear Inverted Pendulum (LIP) dynamics, stabilization strategies, and ankle/hip balance mechanisms."}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Learning Objectives"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Derive Linear Inverted Pendulum (LIP) equations"}),"\n",(0,i.jsx)(e.li,{children:"Implement PD control for balance stabilization"}),"\n",(0,i.jsx)(e.li,{children:"Compare ankle vs. hip strategies for balance recovery"}),"\n",(0,i.jsx)(e.li,{children:"Design ZMP-based reference trajectory tracking"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"1-linear-inverted-pendulum-model-lip",children:"1. Linear Inverted Pendulum Model (LIP)"}),"\n",(0,i.jsxs)(e.p,{children:["The ",(0,i.jsx)(e.strong,{children:"LIP"})," approximates a humanoid's Center of Mass (CoM) as a point mass at constant height ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"z"}),(0,i.jsx)(e.mi,{children:"c"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"z_c"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.044em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"c"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),", connected to a pivot (ankle or ZMP) by a massless rod."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Dynamics"})," (2D sagittal plane):"]}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\xa8"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"\u03c9"}),(0,i.jsx)(e.mn,{children:"2"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\ddot{x} = \\omega^2 (x - x_{\\text{ZMP}})"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6679em"}}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]})})})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.1141em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c9"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.8641em"},children:(0,i.jsxs)(e.span,{style:{top:"-3.113em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsx)(e.p,{children:"Where:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsx)(e.mi,{children:"x"})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})})]}),": CoM horizontal position (m)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_{\\text{ZMP}}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),": ZMP position (m)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"\u03c9"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.msqrt,{children:(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"/"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"z"}),(0,i.jsx)(e.mi,{children:"c"})]})]})})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\omega = \\sqrt{g / z_c}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c9"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.24em",verticalAlign:"-0.305em"}}),(0,i.jsx)(e.span,{className:"mord sqrt",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.935em"},children:[(0,i.jsxs)(e.span,{className:"svg-align",style:{top:"-3.2em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsxs)(e.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"mord",children:"/"}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.044em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"c"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]}),(0,i.jsxs)(e.span,{style:{top:"-2.895em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsx)(e.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.28em"},children:(0,i.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.28em",viewBox:"0 0 400000 1296",preserveAspectRatio:"xMinYMin slice",children:(0,i.jsx)(e.path,{d:"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.305em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]}),": Natural frequency (rad/s)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"9.81"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"g = 9.81"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"9.81"})]})]})]})," m/s\xb2"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Key Insight"}),": If ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"x"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_{\\text{ZMP}} = x"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]})]})]}),", then ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\xa8"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\ddot{x} = 0"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6679em"}}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]})})})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0"})]})]})]})," (equilibrium). If ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:">"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x > x_{\\text{ZMP}}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:">"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),", CoM accelerates away from ZMP (unstable)."]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"2-ankle-vs-hip-strategies",children:"2. Ankle vs. Hip Strategies"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Ankle Strategy"}),": Torque at ankle joint to shift ZMP under CoM. Effective for small disturbances."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Hip Strategy"}),": Bend at hip to reposition CoM over support foot. Used for large disturbances or when ankle torque limits are reached."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Stepping Strategy"}),": Take a step to expand support polygon. Last resort for large perturbations."]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"3-zmp-based-stabilization",children:"3. ZMP-Based Stabilization"}),"\n",(0,i.jsxs)(e.p,{children:["To stabilize LIP, control ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_{\\text{ZMP}}"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]})," such that ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\u2192"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mi,{children:"d"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x \\to x_d"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2192"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})," (desired position)."]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"PD Controller"}),":"]}),"\n",(0,i.jsx)(e.span,{className:"katex-display",children:(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mtext,{children:"ZMP"})]}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsxs)(e.mfrac,{children:[(0,i.jsx)(e.mn,{children:"1"}),(0,i.jsxs)(e.msup,{children:[(0,i.jsx)(e.mi,{children:"\u03c9"}),(0,i.jsx)(e.mn,{children:"2"})]})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsxs)(e.msub,{children:[(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\xa8"})]}),(0,i.jsx)(e.mi,{children:"d"})]}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsx)(e.mi,{children:"p"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mi,{children:"d"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2212"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsx)(e.mi,{children:"d"})]}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"x"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"x_{\\text{ZMP}} = x + \\frac{1}{\\omega^2} (\\ddot{x}_d - K_p (x - x_d) - K_d \\dot{x})"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord text mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"ZMP"})})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"2.0074em",verticalAlign:"-0.686em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(e.span,{className:"mfrac",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c9"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord",children:(0,i.jsx)(e.span,{className:"mord",children:"1"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]})})})}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsx)(e.span,{className:"vlist-t",children:(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.1111em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]})})})}),(0,i.jsx)(e.span,{className:"mclose",children:")"})]})]})]})}),"\n",(0,i.jsx)(e.p,{children:"Where:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsx)(e.mi,{children:"p"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_p"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),": Proportional gain (tracking)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsx)(e.mrow,{children:(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"K"}),(0,i.jsx)(e.mi,{children:"d"})]})}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"K_d"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"K"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"d"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})})]}),": Derivative gain (damping)"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"interactive-exercises",children:"Interactive Exercises"}),"\n",(0,i.jsx)(e.h3,{id:"exercise-621-lip-dynamics-simulator",children:"Exercise 6.2.1: LIP Dynamics Simulator"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"\"\"\"Simulate Linear Inverted Pendulum dynamics.\"\"\"\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom typing import Tuple\n\ndef lip_dynamics(\n    state: np.ndarray,\n    zmp_pos: float,\n    z_com: float = 0.8,\n    g: float = 9.81\n) -> np.ndarray:\n    \"\"\"\n    Compute LIP state derivative.\n\n    Args:\n        state: [x, x_dot] CoM position and velocity (m, m/s)\n        zmp_pos: ZMP position (m)\n        z_com: CoM height (m)\n        g: Gravity (m/s\xb2)\n\n    Returns:\n        state_dot: [x_dot, x_ddot] velocity and acceleration\n    \"\"\"\n    x, x_dot = state\n    omega = np.sqrt(g / z_com)\n    x_ddot = omega**2 * (x - zmp_pos)\n\n    return np.array([x_dot, x_ddot])\n\ndef simulate_lip(\n    initial_state: np.ndarray,\n    zmp_trajectory: np.ndarray,\n    times: np.ndarray,\n    z_com: float = 0.8\n) -> np.ndarray:\n    \"\"\"\n    Simulate LIP over time with given ZMP trajectory.\n\n    Args:\n        initial_state: Initial [x, x_dot] (m, m/s)\n        zmp_trajectory: ZMP positions at each time (m), shape (n,)\n        times: Time array (s), shape (n,)\n        z_com: CoM height (m)\n\n    Returns:\n        states: State history [x, x_dot], shape (n, 2)\n    \"\"\"\n    dt = times[1] - times[0]\n    states = np.zeros((len(times), 2))\n    states[0] = initial_state\n\n    for i in range(len(times) - 1):\n        # Euler integration\n        state_dot = lip_dynamics(states[i], zmp_trajectory[i], z_com)\n        states[i + 1] = states[i] + state_dot * dt\n\n    return states\n\n# Test: Uncontrolled fall from initial offset\ntimes = np.linspace(0, 2.0, 200)\ndt = times[1] - times[0]\n\n# Scenario 1: ZMP fixed at origin (uncontrolled)\nzmp_fixed = np.zeros_like(times)\nstates_uncontrolled = simulate_lip(\n    initial_state=np.array([0.05, 0.0]),  # 5cm offset, zero velocity\n    zmp_trajectory=zmp_fixed,\n    times=times,\n    z_com=0.8\n)\n\n# Scenario 2: ZMP tracks CoM (perfect control)\nstates_controlled = np.zeros((len(times), 2))\nstates_controlled[0] = np.array([0.05, 0.0])\nzmp_controlled = np.zeros_like(times)\n\nfor i in range(len(times) - 1):\n    # Set ZMP to current CoM position\n    zmp_controlled[i] = states_controlled[i, 0]\n    state_dot = lip_dynamics(states_controlled[i], zmp_controlled[i], z_com=0.8)\n    states_controlled[i + 1] = states_controlled[i] + state_dot * dt\n\n# Visualize\nfig, axes = plt.subplots(2, 1, figsize=(10, 8))\n\n# Position plot\naxes[0].plot(times, states_uncontrolled[:, 0], 'r-', linewidth=2, label='Uncontrolled (ZMP=0)')\naxes[0].plot(times, states_controlled[:, 0], 'g-', linewidth=2, label='Controlled (ZMP=x)')\naxes[0].axhline(0, color='black', linestyle='--', alpha=0.3, label='Target')\naxes[0].set_ylabel('CoM Position (m)')\naxes[0].set_title('LIP Dynamics: Position')\naxes[0].legend()\naxes[0].grid(True, alpha=0.3)\n\n# Velocity plot\naxes[1].plot(times, states_uncontrolled[:, 1], 'r-', linewidth=2, label='Uncontrolled')\naxes[1].plot(times, states_controlled[:, 1], 'g-', linewidth=2, label='Controlled')\naxes[1].set_xlabel('Time (s)')\naxes[1].set_ylabel('CoM Velocity (m/s)')\naxes[1].set_title('LIP Dynamics: Velocity')\naxes[1].legend()\naxes[1].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\nprint(f\"Uncontrolled final position: {states_uncontrolled[-1, 0]:.3f} m\")\nprint(f\"Controlled final position: {states_controlled[-1, 0]:.3f} m\")\nprint(f\"Natural frequency omega: {np.sqrt(9.81/0.8):.2f} rad/s\")\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Output"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Uncontrolled: CoM diverges exponentially from origin"}),"\n",(0,i.jsx)(e.li,{children:"Controlled: CoM remains at initial offset (no restoring force)"}),"\n",(0,i.jsx)(e.li,{children:"Natural frequency \u2248 3.5 rad/s for 0.8m height"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"What You Learned"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"LIP dynamics are inherently unstable (exponential divergence)"}),"\n",(0,i.jsx)(e.li,{children:"Simply matching ZMP to CoM maintains current position (no tracking)"}),"\n",(0,i.jsx)(e.li,{children:"Stabilization requires feedback control to drive CoM to target"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"exercise-622-pd-balance-controller",children:"Exercise 6.2.2: PD Balance Controller"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"\"\"\"Implement PD controller for LIP stabilization.\"\"\"\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom typing import Tuple\n\ndef pd_controller(\n    state: np.ndarray,\n    target: float,\n    Kp: float,\n    Kd: float,\n    z_com: float = 0.8,\n    g: float = 9.81\n) -> float:\n    \"\"\"\n    Compute ZMP command using PD control.\n\n    Args:\n        state: [x, x_dot] current CoM state (m, m/s)\n        target: Desired CoM position (m)\n        Kp: Proportional gain\n        Kd: Derivative gain\n        z_com: CoM height (m)\n        g: Gravity (m/s\xb2)\n\n    Returns:\n        zmp_cmd: Commanded ZMP position (m)\n    \"\"\"\n    x, x_dot = state\n    omega = np.sqrt(g / z_com)\n\n    # Error terms\n    error = x - target\n    error_dot = x_dot  # Target velocity is zero\n\n    # PD control law\n    # x_ddot_desired = -Kp * error - Kd * error_dot\n    # From LIP: x_ddot = omega^2 * (x - x_zmp)\n    # Solve for x_zmp:\n    x_ddot_desired = -Kp * error - Kd * error_dot\n    zmp_cmd = x - x_ddot_desired / (omega**2)\n\n    return zmp_cmd\n\ndef simulate_pd_control(\n    initial_state: np.ndarray,\n    target: float,\n    Kp: float,\n    Kd: float,\n    times: np.ndarray,\n    z_com: float = 0.8,\n    zmp_limits: Tuple[float, float] = (-0.1, 0.1)\n) -> Tuple[np.ndarray, np.ndarray]:\n    \"\"\"\n    Simulate LIP with PD control.\n\n    Args:\n        initial_state: Initial [x, x_dot]\n        target: Desired CoM position (m)\n        Kp: Proportional gain\n        Kd: Derivative gain\n        times: Time array (s)\n        z_com: CoM height (m)\n        zmp_limits: (min, max) ZMP bounds (m)\n\n    Returns:\n        states: State history [x, x_dot]\n        zmp_history: ZMP command history\n    \"\"\"\n    dt = times[1] - times[0]\n    states = np.zeros((len(times), 2))\n    zmp_history = np.zeros(len(times))\n\n    states[0] = initial_state\n\n    for i in range(len(times) - 1):\n        # Compute ZMP command\n        zmp_cmd = pd_controller(states[i], target, Kp, Kd, z_com)\n\n        # Apply ZMP limits (saturation)\n        zmp_cmd = np.clip(zmp_cmd, zmp_limits[0], zmp_limits[1])\n        zmp_history[i] = zmp_cmd\n\n        # Simulate dynamics\n        state_dot = lip_dynamics(states[i], zmp_cmd, z_com)\n        states[i + 1] = states[i] + state_dot * dt\n\n    return states, zmp_history\n\n# Test different PD gains\ntimes = np.linspace(0, 3.0, 300)\ninitial_state = np.array([0.15, 0.0])  # 15cm offset\ntarget = 0.0\n\ngains = [\n    (5.0, 3.0, 'Under-damped'),\n    (10.0, 6.0, 'Critically damped'),\n    (15.0, 10.0, 'Over-damped')\n]\n\nfig, axes = plt.subplots(3, 1, figsize=(10, 10))\n\nfor (Kp, Kd, label), color in zip(gains, ['blue', 'green', 'red']):\n    states, zmp = simulate_pd_control(initial_state, target, Kp, Kd, times)\n\n    # Position\n    axes[0].plot(times, states[:, 0], color=color, linewidth=2, label=f'{label} (Kp={Kp}, Kd={Kd})')\n\n    # Velocity\n    axes[1].plot(times, states[:, 1], color=color, linewidth=2, label=label)\n\n    # ZMP\n    axes[2].plot(times, zmp, color=color, linewidth=2, label=label)\n\n# Format plots\naxes[0].axhline(target, color='black', linestyle='--', alpha=0.5, label='Target')\naxes[0].set_ylabel('CoM Position (m)')\naxes[0].set_title('PD Control Response: Position')\naxes[0].legend()\naxes[0].grid(True, alpha=0.3)\n\naxes[1].set_ylabel('CoM Velocity (m/s)')\naxes[1].set_title('PD Control Response: Velocity')\naxes[1].legend()\naxes[1].grid(True, alpha=0.3)\n\naxes[2].axhline(0.1, color='red', linestyle=':', alpha=0.5, label='ZMP Limits')\naxes[2].axhline(-0.1, color='red', linestyle=':', alpha=0.5)\naxes[2].set_xlabel('Time (s)')\naxes[2].set_ylabel('ZMP Command (m)')\naxes[2].set_title('PD Control Response: ZMP')\naxes[2].legend()\naxes[2].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n# Analyze settling time (within 1% of target)\nfor Kp, Kd, label in gains:\n    states, _ = simulate_pd_control(initial_state, target, Kp, Kd, times)\n    settling_idx = np.where(np.abs(states[:, 0] - target) < 0.01 * abs(initial_state[0]))[0]\n    settling_time = times[settling_idx[0]] if len(settling_idx) > 0 else np.inf\n    print(f\"{label}: Settling time = {settling_time:.2f} s\")\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Output"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Under-damped: Oscillations before settling"}),"\n",(0,i.jsx)(e.li,{children:"Critically damped: Fast settling without overshoot"}),"\n",(0,i.jsx)(e.li,{children:"Over-damped: Slow, monotonic approach"}),"\n",(0,i.jsx)(e.li,{children:"ZMP stays within \xb110cm limits"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"What You Learned"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"PD control stabilizes LIP by adjusting ZMP"}),"\n",(0,i.jsx)(e.li,{children:"Higher Kd reduces oscillations (damping)"}),"\n",(0,i.jsx)(e.li,{children:"Higher Kp increases response speed but can cause overshoot"}),"\n",(0,i.jsx)(e.li,{children:"ZMP saturation limits achievable accelerations"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"exercise-623-ankle-vs-hip-strategy-comparison",children:"Exercise 6.2.3: Ankle vs. Hip Strategy Comparison"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"\"\"\"Compare ankle and hip balance strategies.\"\"\"\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom typing import Tuple\n\ndef ankle_strategy(\n    com_offset: float,\n    max_ankle_torque: float = 100.0,\n    robot_mass: float = 60.0,\n    com_height: float = 0.8\n) -> Tuple[float, bool]:\n    \"\"\"\n    Compute ZMP shift using ankle strategy.\n\n    Args:\n        com_offset: CoM horizontal offset from ankle (m)\n        max_ankle_torque: Maximum ankle torque (Nm)\n        robot_mass: Robot mass (kg)\n        com_height: CoM height (m)\n\n    Returns:\n        zmp_shift: Achievable ZMP displacement (m)\n        feasible: Whether ankle strategy can handle disturbance\n    \"\"\"\n    # Required torque to balance: tau = m * g * com_offset\n    required_torque = robot_mass * 9.81 * com_offset\n\n    if abs(required_torque) <= max_ankle_torque:\n        # ZMP shift equals CoM offset (perfect compensation)\n        zmp_shift = com_offset\n        feasible = True\n    else:\n        # Saturate at max torque\n        zmp_shift = np.sign(com_offset) * max_ankle_torque / (robot_mass * 9.81)\n        feasible = False\n\n    return zmp_shift, feasible\n\ndef hip_strategy(\n    com_offset: float,\n    max_hip_angle: float = 0.3,\n    com_height: float = 0.8\n) -> Tuple[float, bool]:\n    \"\"\"\n    Compute hip angle to reposition CoM.\n\n    Args:\n        com_offset: CoM horizontal offset from support (m)\n        max_hip_angle: Maximum hip flexion angle (rad)\n        com_height: CoM height (m)\n\n    Returns:\n        hip_angle: Required hip angle (rad)\n        feasible: Whether hip strategy can handle disturbance\n    \"\"\"\n    # Approximate: hip_angle \u2248 com_offset / com_height (small angle)\n    required_angle = com_offset / com_height\n\n    if abs(required_angle) <= max_hip_angle:\n        hip_angle = required_angle\n        feasible = True\n    else:\n        hip_angle = np.sign(required_angle) * max_hip_angle\n        feasible = False\n\n    return hip_angle, feasible\n\n# Test range of disturbances\ncom_offsets = np.linspace(0, 0.3, 50)  # 0 to 30cm\n\nankle_shifts = []\nankle_feasibility = []\nhip_angles = []\nhip_feasibility = []\n\nfor offset in com_offsets:\n    zmp, ankle_ok = ankle_strategy(offset, max_ankle_torque=100.0)\n    ankle_shifts.append(zmp)\n    ankle_feasibility.append(ankle_ok)\n\n    angle, hip_ok = hip_strategy(offset, max_hip_angle=0.3)\n    hip_angles.append(angle)\n    hip_feasibility.append(hip_ok)\n\nankle_shifts = np.array(ankle_shifts)\nhip_angles = np.array(hip_angles)\n\n# Visualize\nfig, axes = plt.subplots(1, 2, figsize=(14, 5))\n\n# Ankle strategy\nax1 = axes[0]\nax1.plot(com_offsets * 100, ankle_shifts * 100, 'b-', linewidth=2, label='ZMP Shift')\nax1.axhline(10, color='red', linestyle='--', alpha=0.5, label='Support Limit (\xb110cm)')\nax1.axhline(-10, color='red', linestyle='--', alpha=0.5)\n\n# Mark feasibility boundary\nfeasible_ankle = com_offsets[np.array(ankle_feasibility)]\ninfeasible_ankle = com_offsets[~np.array(ankle_feasibility)]\n\nif len(feasible_ankle) > 0:\n    ax1.axvspan(0, feasible_ankle[-1] * 100, alpha=0.2, color='green', label='Feasible')\nif len(infeasible_ankle) > 0:\n    ax1.axvspan(infeasible_ankle[0] * 100, com_offsets[-1] * 100, alpha=0.2, color='red', label='Infeasible')\n\nax1.set_xlabel('CoM Offset (cm)')\nax1.set_ylabel('ZMP Shift (cm)')\nax1.set_title('Ankle Strategy: ZMP Compensation')\nax1.legend()\nax1.grid(True, alpha=0.3)\n\n# Hip strategy\nax2 = axes[1]\nax2.plot(com_offsets * 100, np.rad2deg(hip_angles), 'g-', linewidth=2, label='Hip Angle')\nax2.axhline(np.rad2deg(0.3), color='red', linestyle='--', alpha=0.5, label='Hip Limit (\xb117\xb0)')\nax2.axhline(-np.rad2deg(0.3), color='red', linestyle='--', alpha=0.5)\n\n# Mark feasibility\nfeasible_hip = com_offsets[np.array(hip_feasibility)]\ninfeasible_hip = com_offsets[~np.array(hip_feasibility)]\n\nif len(feasible_hip) > 0:\n    ax2.axvspan(0, feasible_hip[-1] * 100, alpha=0.2, color='green', label='Feasible')\nif len(infeasible_hip) > 0:\n    ax2.axvspan(infeasible_hip[0] * 100, com_offsets[-1] * 100, alpha=0.2, color='red', label='Infeasible')\n\nax2.set_xlabel('CoM Offset (cm)')\nax2.set_ylabel('Hip Angle (degrees)')\nax2.set_title('Hip Strategy: Hip Flexion')\nax2.legend()\nax2.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n# Find crossover point\nankle_limit = ankle_shifts[np.array(ankle_feasibility)][-1] if np.any(ankle_feasibility) else 0\nhip_limit = com_offsets[np.array(hip_feasibility)][-1] if np.any(hip_feasibility) else 0\n\nprint(f\"Ankle strategy limit: {ankle_limit * 100:.1f} cm\")\nprint(f\"Hip strategy limit: {hip_limit * 100:.1f} cm\")\nprint(f\"Recommendation: Use ankle for < {ankle_limit * 100:.1f} cm, hip for larger disturbances\")\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Output"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Ankle strategy saturates around 10-15cm offset (torque limit)"}),"\n",(0,i.jsx)(e.li,{children:"Hip strategy handles larger offsets (up to 24cm for 0.3 rad limit)"}),"\n",(0,i.jsx)(e.li,{children:"Green/red regions show feasible/infeasible ranges"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"What You Learned"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Ankle strategy is efficient for small disturbances (direct ZMP control)"}),"\n",(0,i.jsx)(e.li,{children:"Hip strategy extends balance range but requires larger joint motion"}),"\n",(0,i.jsx)(e.li,{children:"Hybrid approach: ankle first, then hip if needed, finally step"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"exercise-624-push-recovery-simulation",children:"Exercise 6.2.4: Push Recovery Simulation"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"\"\"\"Simulate balance recovery from external push.\"\"\"\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom typing import Tuple\n\ndef simulate_push_recovery(\n    push_magnitude: float,\n    push_time: float,\n    Kp: float = 10.0,\n    Kd: float = 6.0,\n    duration: float = 3.0,\n    dt: float = 0.01\n) -> Tuple[np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\n    Simulate LIP response to impulsive push.\n\n    Args:\n        push_magnitude: Push impulse (m/s velocity change)\n        push_time: Time of push application (s)\n        Kp: PD proportional gain\n        Kd: PD derivative gain\n        duration: Simulation duration (s)\n        dt: Time step (s)\n\n    Returns:\n        times: Time array\n        states: [x, x_dot] state history\n        zmp: ZMP command history\n    \"\"\"\n    times = np.arange(0, duration, dt)\n    states = np.zeros((len(times), 2))\n    zmp = np.zeros(len(times))\n\n    z_com = 0.8\n    omega = np.sqrt(9.81 / z_com)\n    target = 0.0\n\n    for i in range(len(times) - 1):\n        # Apply push at specified time\n        if abs(times[i] - push_time) < dt / 2:\n            states[i, 1] += push_magnitude  # Velocity impulse\n\n        # PD control\n        x, x_dot = states[i]\n        error = x - target\n        x_ddot_cmd = -Kp * error - Kd * x_dot\n        zmp_cmd = x - x_ddot_cmd / (omega**2)\n\n        # Saturate ZMP\n        zmp_cmd = np.clip(zmp_cmd, -0.1, 0.1)\n        zmp[i] = zmp_cmd\n\n        # Dynamics\n        x_ddot = omega**2 * (x - zmp_cmd)\n        states[i + 1, 0] = x + x_dot * dt\n        states[i + 1, 1] = x_dot + x_ddot * dt\n\n    return times, states, zmp\n\n# Test different push magnitudes\npush_magnitudes = [0.1, 0.2, 0.3]  # m/s\ncolors = ['blue', 'orange', 'red']\npush_time = 0.5\n\nfig, axes = plt.subplots(3, 1, figsize=(10, 10))\n\nfor push_mag, color in zip(push_magnitudes, colors):\n    times, states, zmp = simulate_push_recovery(\n        push_magnitude=push_mag,\n        push_time=push_time,\n        Kp=10.0,\n        Kd=6.0\n    )\n\n    # Position\n    axes[0].plot(times, states[:, 0] * 100, color=color, linewidth=2,\n                 label=f'Push: {push_mag} m/s')\n\n    # Velocity\n    axes[1].plot(times, states[:, 1], color=color, linewidth=2,\n                 label=f'Push: {push_mag} m/s')\n\n    # ZMP\n    axes[2].plot(times, zmp * 100, color=color, linewidth=2,\n                 label=f'Push: {push_mag} m/s')\n\n# Format\naxes[0].axvline(push_time, color='black', linestyle='--', alpha=0.3, label='Push Time')\naxes[0].set_ylabel('CoM Position (cm)')\naxes[0].set_title('Push Recovery: CoM Position')\naxes[0].legend()\naxes[0].grid(True, alpha=0.3)\n\naxes[1].axvline(push_time, color='black', linestyle='--', alpha=0.3)\naxes[1].set_ylabel('CoM Velocity (m/s)')\naxes[1].set_title('Push Recovery: CoM Velocity')\naxes[1].legend()\naxes[1].grid(True, alpha=0.3)\n\naxes[2].axhline(10, color='red', linestyle=':', alpha=0.5, label='ZMP Limit')\naxes[2].axhline(-10, color='red', linestyle=':', alpha=0.5)\naxes[2].axvline(push_time, color='black', linestyle='--', alpha=0.3)\naxes[2].set_xlabel('Time (s)')\naxes[2].set_ylabel('ZMP (cm)')\naxes[2].set_title('Push Recovery: ZMP Command')\naxes[2].legend()\naxes[2].grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n\n# Analyze recovery time\nfor push_mag in push_magnitudes:\n    times, states, _ = simulate_push_recovery(push_mag, push_time)\n    recovery_idx = np.where((times > push_time + 0.5) & (np.abs(states[:, 0]) < 0.01))[0]\n    if len(recovery_idx) > 0:\n        recovery_time = times[recovery_idx[0]] - push_time\n        max_excursion = np.max(np.abs(states[times > push_time, 0])) * 100\n        print(f\"Push {push_mag} m/s: Recovery in {recovery_time:.2f}s, Max: {max_excursion:.1f}cm\")\n    else:\n        print(f\"Push {push_mag} m/s: Did not recover (exceeded limits)\")\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Output"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Larger pushes \u2192 larger CoM excursions"}),"\n",(0,i.jsx)(e.li,{children:"ZMP saturates for strong pushes (limits recovery acceleration)"}),"\n",(0,i.jsx)(e.li,{children:"All disturbances < 0.3 m/s recover within 2-3 seconds"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"What You Learned"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Push recovery requires rapid ZMP adjustment"}),"\n",(0,i.jsx)(e.li,{children:"ZMP saturation limits disturbance rejection capability"}),"\n",(0,i.jsx)(e.li,{children:"Recovery time increases with disturbance magnitude"}),"\n",(0,i.jsx)(e.li,{children:"If ZMP limits insufficient, stepping strategy required"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"trywithai-exercises",children:"TryWithAI Exercises"}),"\n",(0,i.jsx)(e.h3,{id:"trywithai-621-adaptive-balance-controller",children:"TryWithAI 6.2.1: Adaptive Balance Controller"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Prompt"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Design an adaptive balance controller for a humanoid robot that estimates and compensates for unknown external forces (e.g., wind, payload). The controller should:\n\n1. Use a Kalman filter to estimate constant external force from CoM state observations\n2. Augment PD control with feedforward compensation based on estimated force\n3. Demonstrate improved disturbance rejection compared to standard PD control\n4. Visualize force estimation convergence and CoM tracking error\n\nTest with step force (constant push) and ramp force (gradually increasing load). Compare performance with and without adaptation.\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Skills"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Kalman filtering for state and parameter estimation"}),"\n",(0,i.jsx)(e.li,{children:"Feedforward control design"}),"\n",(0,i.jsx)(e.li,{children:"Disturbance observer patterns"}),"\n",(0,i.jsx)(e.li,{children:"Performance metric analysis (settling time, overshoot)"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"trywithai-622-multi-contact-balance-optimization",children:"TryWithAI 6.2.2: Multi-Contact Balance Optimization"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Prompt"}),":"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Implement a balance controller for a humanoid using multiple contact points (two feet, optionally hands on wall). The system should:\n\n1. Compute the combined support polygon from all active contacts\n2. Optimize ZMP location within the polygon to minimize control effort\n3. Decide when to activate/deactivate contacts based on stability margin\n4. Visualize the support polygon, CoM projection, and contact forces\n\nTest scenarios: narrow ledge (requires hand support), wide stance (two feet only), single-foot balance. Show how additional contacts expand stability region.\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected Skills"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Convex hull computation for support polygon"}),"\n",(0,i.jsx)(e.li,{children:"Constrained optimization (minimize effort subject to stability)"}),"\n",(0,i.jsx)(e.li,{children:"Contact state management"}),"\n",(0,i.jsx)(e.li,{children:"Force distribution across multiple contacts"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(e.p,{children:"This lesson covered balance control for humanoid robots:"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Key Concepts"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Linear Inverted Pendulum (LIP) simplifies humanoid dynamics"}),"\n",(0,i.jsx)(e.li,{children:"ZMP control stabilizes LIP by adjusting ground reaction point"}),"\n",(0,i.jsx)(e.li,{children:"Ankle, hip, and stepping strategies handle different disturbance magnitudes"}),"\n",(0,i.jsx)(e.li,{children:"PD control provides feedback stabilization"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Practical Skills"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Simulating LIP dynamics"}),"\n",(0,i.jsx)(e.li,{children:"Implementing PD controllers for ZMP tracking"}),"\n",(0,i.jsx)(e.li,{children:"Comparing ankle vs. hip balance strategies"}),"\n",(0,i.jsx)(e.li,{children:"Analyzing push recovery performance"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Next Steps"}),": ",(0,i.jsx)(e.a,{href:"/physical-ai-book/ur/docs/chapter-06/lesson-03",children:"Lesson 6.3"})," explores whole-body motion planning with inverse kinematics and center-of-mass constraints."]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Further Reading"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:['Kajita, S., et al. (2001). "The 3D Linear Inverted Pendulum Mode: A simple modeling for a biped walking pattern generation." ',(0,i.jsx)(e.em,{children:"IEEE/RSJ IROS"}),"."]}),"\n",(0,i.jsxs)(e.li,{children:['Pratt, J., et al. (2006). "Capture Point: A Step toward Humanoid Push Recovery." ',(0,i.jsx)(e.em,{children:"IEEE-RAS Humanoids"}),"."]}),"\n"]})]})}function o(s={}){const{wrapper:e}={...(0,l.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(h,{...s})}):h(s)}}}]);